<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>Fluffy Bird</title>
<style>
  body { margin:0; overflow:hidden; display:flex; justify-content:center; align-items:flex-start; background:skyblue; font-family:Arial,sans-serif; }
  #ui { margin-left:20px; color:#fff; }
  #title { font-size:32px; margin-bottom:12px; text-shadow:0 0 8px #fff; }
  #colorPicker { display:flex; gap:8px; margin-bottom:12px; }
  .colorOption { width:30px; height:30px; border-radius:50%; cursor:pointer; border:2px solid #fff; }
  #startBtn { background:#1e90ff; border:none; color:#fff; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:16px; }
  canvas { display:block; background:skyblue; border-radius:6px; box-shadow:0 6px 12px rgba(0,0,0,0.5); }
  #note { color:#fff; font-size:14px; background: rgba(0,0,0,0.35); padding:4px 6px; border-radius:6px; margin-top:6px; }
</style>
</head>
<body>

<canvas id="game" width="400" height="600"></canvas>

<div id="ui">
  <div id="title">Fluffy Bird</div>
  <div>Pilih Warna Burung:</div>
  <div id="colorPicker">
    <div class="colorOption" style="background:yellow;" data-color="yellow"></div>
    <div class="colorOption" style="background:red;" data-color="red"></div>
    <div class="colorOption" style="background:green;" data-color="green"></div>
    <div class="colorOption" style="background:orange;" data-color="orange"></div>
    <div class="colorOption" style="background:cyan;" data-color="cyan"></div>
  </div>
  <button id="startBtn">Mulai Game</button>
  <div id="note">Tekan SPACE / Klik / Sentuh untuk terbang</div>
</div>

<script>
(() => {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const CANVAS_W = canvas.width;
  const CANVAS_H = canvas.height;

  // Pilih warna burung
  let birdColor = 'yellow';
  const colorOptions = document.querySelectorAll('.colorOption');
  colorOptions.forEach(opt=>{
    opt.addEventListener('click', ()=>{
      birdColor = opt.dataset.color;
      colorOptions.forEach(o=>o.style.border='2px solid #fff');
      opt.style.border='2px solid #000';
    });
  });

  // Bird dan game state
  const BIRD_W = 34, BIRD_H = 24;
  let bird = { x:70, y:250, width:BIRD_W, height:BIRD_H, velocity:0, gravity:0.5, lift:-9 };
  let pipes = [], frame=0, gameOver=false, score=0, gameStarted=false;
  const PIPE_WIDTH = 52, gap = 190;

  // Fungsi draw
  function drawBackground(){
    ctx.fillStyle = '#87CEEB';
    ctx.fillRect(0,0,CANVAS_W,CANVAS_H);
  }

  function drawBird(){
    ctx.fillStyle = birdColor;
    ctx.fillRect(bird.x,bird.y,bird.width,bird.height);
    // mata
    ctx.fillStyle = 'black';
    ctx.fillRect(bird.x+bird.width-8,bird.y+6,4,4);
  }

  function drawPipes(){
    ctx.fillStyle = 'green';
    pipes.forEach(p=>{
      ctx.fillRect(p.x,0,PIPE_WIDTH,p.top);
      ctx.fillRect(p.x,p.bottomY,PIPE_WIDTH,CANVAS_H-p.bottomY);
    });
  }

  function drawScore(){
    ctx.fillStyle='white';
    ctx.font='32px Arial';
    ctx.textAlign='center';
    ctx.fillText(score,CANVAS_W/2,80);
  }

  function endGame(){
    gameOver=true;
    ctx.fillStyle='rgba(0,0,0,0.5)';
    ctx.fillRect(0,0,CANVAS_W,CANVAS_H);
    ctx.fillStyle='white';
    ctx.font='48px Arial';
    ctx.textAlign='center';
    ctx.fillText('Game Over',CANVAS_W/2,CANVAS_H/2-20);
    ctx.font='20px Arial';
    ctx.fillText('Tekan SPACE / Klik untuk Restart',CANVAS_W/2,CANVAS_H/2+20);
  }

  // Update
  function updateBird(){
    bird.velocity+=bird.gravity;
    bird.y+=bird.velocity;
    if(bird.y+bird.height>CANVAS_H) endGame();
    if(bird.y<0) bird.y=0;
  }

  function updatePipes(){
    if(frame%90===0){
      const top=Math.random()*(CANVAS_H-gap-100)+40;
      pipes.push({x:CANVAS_W, top:top, bottomY:top+gap, passed:false});
    }
    pipes.forEach(p=>p.x-=2.2);
    pipes=pipes.filter(p=>p.x+PIPE_WIDTH>0);

    pipes.forEach(p=>{
      if(!p.passed && p.x+PIPE_WIDTH<bird.x){ score++; p.passed=true; }
      if(bird.x<p.x+PIPE_WIDTH && bird.x+bird.width>p.x){
        if(bird.y<p.top || bird.y+bird.height>p.bottomY) endGame();
      }
    });
  }

  function gameLoop(){
    if(!gameStarted) return;
    if(gameOver) return;

    ctx.clearRect(0,0,CANVAS_W,CANVAS_H);
    drawBackground();
    drawPipes();
    drawBird();
    drawScore();
    updateBird();
    updatePipes();
    frame++;
    requestAnimationFrame(gameLoop);
  }

  function flap(){
    if(!gameStarted) return;
    if(gameOver) resetGame();
    bird.velocity = bird.lift;
  }

  function resetGame(){
    bird.y=250; bird.velocity=0;
    pipes=[]; score=0; frame=0; gameOver=false;
    requestAnimationFrame(gameLoop);
  }

  document.addEventListener('keydown', e=>{ if(e.code==='Space') flap(); });
  canvas.addEventListener('mousedown', flap);
  canvas.addEventListener('touchstart', e=>{ e.preventDefault(); flap(); }, {passive:false});

  document.getElementById('startBtn').addEventListener('click', ()=>{
    gameStarted=true;
    resetGame();
  });

})();
</script>
</body>
</html>

